<section class="hero is-success">
  <div class="hero-body">
    <div class="container">
      <h1 class="title">
        プロダクト一覧
      </h1>
    </div>
  </div>
</section>

<section class="section">
    <div class="container">
        <div class="columns is-multiline">
            <% @products.each do |product| %>
                <div class="column is-4">
                    <div class="card">
                        <div class="card-image">
                          <figure class="image is-4by3">
                            <%= link_to product_path(product) do %>
                                <%= attachment_image_tag product, :image %>
                            <% end %>
                          </figure>
                        </div>

                        <% if user_signed_in? %>
                            <% if product.favorited_by?(current_user) %>
                                <p><span>いいね解除:</span><%= link_to product.favorites.count, product_favorites_path(product.id), method: :delete %></p>
                            <% else %>
                                <p><span>いいね登録:</span><%= link_to product.favorites.count, product_favorites_path(product.id), method: :post %></p>
                            <% end %>
                          <% else %>
                          <p><span>いいね数</span><%= product.favorites.count%></p>
                        <% end %>
                        
                        <div class="media-content">
                            <div class="media">
                                <div class="media-left">
                                    <figure class="image is-48x48">
                                        <%= attachment_image_tag product.user, :profile_image, fallback: "no-image.png", class: "profile_image" %>
                                    </figure>
                                </div>
                                <div class="media-content">
                                    <div class="title"><%= link_to product.user.username, user_path(product.user) %></div>
                                </div>
                            </div>
                            <div class="content">
                                <time><%= product.updated_at.strftime("%Y-%m-%d %H:%M")%></time>更新
                            </div>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
</section>

